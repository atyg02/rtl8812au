--- a/core/rtw_sta_mgt.c	2017-02-11 16:39:20.000000000 +0100
+++ b/core/rtw_sta_mgt.c	2017-02-12 23:26:15.641690669 +0100
@@ -336,10 +336,16 @@
 
 	//_enter_critical_bh(&(pfree_sta_queue->lock), &irqL);
 	_enter_critical_bh(&(pstapriv->sta_hash_lock), &irqL2);
-	if (_rtw_queue_empty(pfree_sta_queue) == _TRUE)
+	
+	if (!pstapriv->padapter->pnetdev)
+	{
+		psta = NULL;
+	}
+
+	else if (_rtw_queue_empty(pfree_sta_queue) == _TRUE)
 	{
 		//_exit_critical_bh(&(pfree_sta_queue->lock), &irqL);
-		_exit_critical_bh(&(pstapriv->sta_hash_lock), &irqL2);
+		//_exit_critical_bh(&(pstapriv->sta_hash_lock), &irqL2);
 		psta = NULL;
 	}
 	else
